
## 주통기반
계정관리   
비밀번호, 불필요 계정, default, session timeout

파일 및 디렉토리 관리   
파일 디렉토리 별 권한이 어떤 게 들어가야 하는지 알고 있어야 함

서비스 관리   
port

패치 관리   
운영중인 시스템에서 관리를 해야 할 소프트웨어가 어떤 게 있는지,   
그 소프트웨어의 패치 관리를 어떻게 해야 하는지

로그 관리   


## 계정관리

### 1.3 임계값 설정
3, 5, 10회 임계값 설정은 해당 회사 내부 설정에 따라서 달라질 수 있다.

기준에는 5회로 되어 있는데 실제로 3회로 보안이 더 강화되어 있으면 ㄱㅊ

기준에는 5회로 되어 있는데 실제로 10회로 보안이 더 약화되어 있어서 취약

### 1.4 패스워드 파일 보호
passwd, shadow 파일이 탈취되었을 때를 가정해서 암호화가 되어 있어야 함

보통은 script로 툴이 다 있음.   
어떤 항목들을 점검한다는 생각들이 있어야 함   
수동으로 하는 방법도 조금 알면 좋고

### 1.5 root 이외의 UID 0 금지
UID 동일한 계정이 있다면 시스템에서 혼선이 일어날 수 있음.  
UID를 가지고 권한 등 관리를 하는데 root UID와 동일하면 원래 그 계정에 주면 안되는 권한을 주는 등 권한 관리에 실패할 수 있음

일반 계정이 root처럼 동작 가능함

### 1.6 root 계정 su 제안
su는 통제를 잘 해야 함

일반 계정에서 root 계정으로 바로 권한 상승이 가능해짐

su 그룹 안에에 있는 계정만 su 명령어가 가능하도록

su그룹에 포함되지 않는 일반 사용자의 su 명령어 차단

일반 사용자가 su를 할 수 있는 방법을 구했으면 취약

### 1.7 패스워드 최소 길이 설정
최소길이가 8자리 이상

알지만 4자리가 최대인 경우는?   
그럼 어떻게 보완할 수 있을까? 다른 방법을 고민해봐야 함    
프로그램 자체적 암호라던지

### 1.8 패스워드 최대 사용기간 설정
주통기반에는 분기(12주)이지만   
반기(24주)로 설정되어 있으면 취약?

커뮤니케이션이 필요하다

기준3개월. 현황6개월.   
결과 : 미흡   
위험처리 : 수용   
우리는 3개월이 아니라 6개월로 하기로 정해져있다   
-> 양호로 해도 됨. 

비밀번호 주기적 변경의 목적이 타당하면 양호


### 1.9 패스워드 최소 사용기간 설정
비밀번호를 계속 바꿔서 비밀번호 history 기억하는 것을 회피하기 위해   
계속 바꾸는 것을 방지


### 1.10 불필요한 계정 제거
실제로 판단하기가 어려움

담당자하고 같이 review를 해야 함.   

5개 활성화 -> 취약일 수도 있고   
100개 활성화 -> 양호일 수도 있음

갯수로는 판단이 불가능하고   
계정 하나하나 목적이 무엇인가가 중요함


스크립트 돌려서 살아있는 계정을 확인해서 담당자와 이야기를 해봐야 함

### 1.11 관리자 그룹에 최소한의 계정 포함
방화벽이 해당 회사 소유인데   
방화벽을 원격으로 모니터링 하는 서비스 이용하는 경우

모니터링 계정이 read만 해도 되는데, write, excute까지 다 권한이 되어 있을 수 있음

### 1.12 계정이 존재하지 않는 GIU 금지
GID : 그룹안에 사용자들을 통합해서 관리하겠다는 의미 

멤버가 없는 그룹? = 관리가 되지 않는다

GID 안에 유저들을 보고 그게 타당한지 아닌지 판단함

### 1.13 동일한 UID 금지
계정을 하나씩 만드는 이유는 책임추적성. 각각의 계정별로 적합한 권한을 부여해서 관리하기 위함인데

하나의 ID에 다수가 동일한 UID를 가지고 있다면   
매핑이 안되서 누가 누구인지 모름    
또한 과도한 권한이 될 수도 있고, 최소한의 권한을 부여하지 않은 경우가 있을 수 있음

### 1.14 사용자 shell 점검
로그인이 불필요한 계정에 쉘 부여를 하면 안된다.   
(adm, sys, daemon)

### 1.15 session timeout 설정
양호 취약 기준이 10분.    

동시 세션제어   
세션이 하나 연결되어 있는 상태에서 세션이 하나 더 연결이 되면   
새로운 세션이나, 기존 세션이나 어느 한쪽은 끊어버려야 함

10시간 세션 유지여도 따져봐야 한다?    
모니터링 업무 부서의 경우는 세션 10분 걸어놓으면 10분마다 로그인하는 경우가 있을 수도 있음   
그래서 세션 타임아웃을 좀 길게 가져갈 수도 있음

**세션 타임아웃의 목적을 고려해야 함**    
특정 시스템의 접근을 막기 위함인데

단순하게 값을 입력하거나 단순하게 값을 불러오는 정도의 역할을 하는 계정이라면   
특별한 위험이 존재하지 않는 계정이라면 더 길게 설정할 수도 있다. 


다른 보안대책을 마련하라.     
업무 특성상 업무시간 하루종일 할 경우    
출근해서 퇴근할 때까지 수준으로 설정하던가   
근데 새로 로그인을 

### 2.1 root홈, 패스 디렉터리 권한 및 패스 설정
주로 시스템 파일, 특정 계정 권한을 가지고 있는 파일, 소유자 또는 권한이 없는 사람이 함부로 접근해서 행위를 할 수 있는 가능성이 있는 곳

시스템파일이나, 시스템 디렉토리는 주로 관리자들이 접근해서 관리하는 게 목적인데    
일반 이용자가 시스템 관련된 곳에 접근할 수 있다면    
의도적이든 비의도적이든 위험 가능성이 존재하기 때문에 막아야 함

**이 시스템 상에서는 주요한 파일과 디렉터리가 어떤 것들이 있는지?**    
누구에게만 권한을 줘야하는지???


PATH 환경 변수? 잘 모르겠다


### 2.2 파일 및 디렉터리 소유자 설정
자산에 대한 소유자가 있어야 하고,   
소유자가 해당 파일의 운영을 제일 잘하기 때문?

소유자가 명확하지 않으면? = 관리가 되지 않고 있다

신청자가 시스템 접근 권한을 신청하면    
신청자의 정보를 보고 신청한 권한이 타당한지 체크해서 권한 부여하는 것    

다른 방법으로
이를태면 권한을 가지고 있는 사람과 협조를 통해서 특별히 권한을 갖지 않아도 업무 처리를 할 수 있게


### 2.3 /etc/passwd 파일 소유자 및 권한 설정
passwd 파일 소유자는 무조건 root

권한이 644 이하인 경우는 양호 rw-r--r-   

파일이나 디렉토리에 대해서 적정 권한(커미션)이 뭔지도 알고 있어야 함


### 2.4 /etc/shadow 파이 소유자 및 권한 설정
shadow 파일 소유자는 root, 권한은 400

### 2.5 /etc/hosts 파일 소유자 및 권한 설정
hosts 파일 소유자는 root, 권한은 600

### 2.6 /etc/(x)inetd.conf 파일 소유자 및 권한 설정
inetd.conf 파일 소유자는 root, 권한은 600

### 2.7
### 2.8 /etc/services 파일 소유자 및 권한 설정
services 파일 소유자가 root(또는 bin, sys), 권한은 644

### 2.9 SUID, SGID 설정 파일점검

### 2.10 사용자, 시스템 시작파일 및 환경파일 소유자 및 권한 설정
환경파일은 중요하니까   
참고에 있는 환경변수 파일 종류를 확인

스크립트가 없으면 일일히 다 검색해봐야 함   
못하는 건 아니지만 비효율적이다

### 2.11 world writable 파일 점검

rwxrwxrwx root root <파일명>

목적이 있으니까 이렇게 권한을 다 줬겠지만   
추적관리를 하지 않으면 계속 방치가 되기 떄문에   
방치되는 게 있는지 확인해보는 것

### 2.12 /dev에 존재하지 않는 device 파일 점검
물리적 매체에 대한 통제를 하는 것

존재하지도 않는 장치 유형을 dev 디렉토리에 연결되어 있으면 악용 가능성이 있음   
관리가 되고 있는지 확인

### 2.13 $HOME/.rhosts, hosts.equiv 사용 금지
원격에서 가능하다는 것은 로컬에 제한된 영역이 아니라
외부 불특정 다수가 원격으로 사용하거나 제어할 수 있게 되는다는 의미

통제되지 않는 접근이 발생할 수 있기 떄문에

위 파일 소유자나 권한이 어떤지 확인

### 2.14 접속 IP 및 포트 제한
접근통제를 할 수 있는 방법이 많다?   




운영 관리자 PC에서 ASW - BSW - FW - SW - 서버

1.서버팜의 FW방화벽    
FW - SW - 서버 : 서버팜

2.서버의 서버접근제어 솔루션   
서버팜에서 서버접근제어를 통해 

3.개별 host에서 TCP Wrapper, IPFilter, IPtables 같은 방법을 통해서 사용

AWS의 SG(Security Group, 보안그룹) = TCP Wrapper, IPFilter, IPtables 같은 방법들과 비슷함    
```
Src                 Dst
0.0.0.0/16 all      0.0.0.0

/16 = 16bit => 0.0.*.* (* 부분에 뭐가 들어와도 다 허용해준다는 의미)   
all = port도 전체 허용해준다는 것이기 떄문에 과도하게 열려있음
```
```
    1       2       3
            ...
    any     any     allow
            ...     ...
    any     any     deny

1번 같은 경우는 다 허용해버림
3번도
```

### 3.1 Finger 서비스 비활성화
불필요한 서비스

### 3.2 Anonymous FTP 비활성화
공격자가 파일 업로드를 한다던지

안에 있는 파일을 외부로 누구나 가져나갈 수 있음

### 3.3 r 계열 서비스 비활성화
불필요한 r 계열 = 필요한지 아닌지 확인하는 절차   
r command 에 대해서 알고 있어야 함

실제 활성화했는지 비활성화했는지 알아보는 것 

### 3.4 crond 파일 소유자 및 권한 설정
시스템 활동을 주기적으로 이행하기 위해 사용하는데

일반 사용자는 사용하지 못하고 cron고ㅓㅏㄴ련 파일 644

### 3.5 DoS 공격에 취약한 서비스 비활성화
사용하지 않는 DoS공격에 취약한 서비스가 비활성화?

그럼 사용하지만 취약한 서비스는?

### 3.6 NFS ㅅ ㅓ비스 비화섫와
활 비활 판단

### 3.7 NFS 접근 통제
꼭 필요한 사람한테만 허용하고 everyone 공유 제한

일반인들이 NFS에 접근할 일은 없음

잘못되서 허용해버리면 악용될 가능성 있음

### 3.8 automountd 제거
메일 시스템이나 망연계 시스템이나 파일이 오고가는 것에 있어서 다운로드 할 때 악성코드 방지 로직이 들어가고

접근하자마자 마운트되는 것들은 안되도록 통제가 필요하다

필요한 경우는 마운트 작업을 해서 붙여라

### 3.9 RPC 서비스 확인
remote해서 Procedure를 Call하는 것이기 떄문에
안전하지 않은 것을 호출해서

함수가 작동해서 내부 악성 프로그램이 실행될 수 있음

마지막 d가 데몬임 <- 이게 뭘까

### 3.10 NIS,NIS+ 점검

### 3.11 tftp, talk 서비스 비활성화

### 3.12 sendmail 버전 점검
정찰하면서 내부 정보 수집   
수집한 정보로 어떤 서비스 구동하는지 확인하고   
그 서비스의 취약점을 판단해서   
그 취약점을 가지고 있는 버전을 쓰고 있다면   
그것을 토대로 공격

sendmail 안전한 버전인지 확인해보는 과정

#### 보호나라 - 보안공지
sendmail 검색하면 나오긴 함   
ssl 검색하면 많이 나오네


☆위협 인텔리전스 :   
내가 보호해야 할 대상들에 대해서 어떤 위협들이 있는지 수집하고    
수집한 정보를 기반으로 내부 체계를 어떻게 할 건지에 대한 프로세스



### 3.13 스팸 메일 릴레이 제한
a가 b에게 메일을 보내면    
a의 메일 서버가 b의 메일 서버가 받아서 b에게 보여주는 건데    

a가 b메일서버로 메일을 보내면   
b메일서버가 b에게 메일을 다시 전송해주고 있음

b메일서버는 스팸메일 경유지가 될 수 있음

### 3.14 

### 3.15 DNS 보안 버전 패치
보안패치가 안되어 있는 BIND를 쓰고 있는 경우가 있음   

어떤 버전을 쓰고 있는지 관리를 하고 있어야 함

방화벽 펌웨어보여달라고 하면 취약한 버전을 쓰고 있는 경우가 너무 많암

### 3.16 DNS Zone Tranfer 설정
존 트랜스퍼를 사용하지 않거나...

### 3.17 웹서비스 디렉토리 리스팅 제거
사이트를 들어갔더니 그 사이틍 ㅔ파일을 설치하도록 하는게 있음

파일을 설치했더니 파일 디렉토리 정보가 있음

상위 디렉토리를 쳤더니

설치 파일을 포함한 디렉토리들을 볼 수 있게 되어있었음

디렉토리구조를 파악해서 그 안에 파일을 업로드 한다던지 악용 가능

### 3.18 웹 서비스 웹 프로세스 권한 제한
아파치를 쓰지 않으면 N/A

### 3.19 웹서비스 상위 디렉토리 접근 금지
. or .. 등

### 3.20 웹서비스 불필요한 파일 제거
그럼 아파치를 안쓰고 다른 WAS를 쓴다면?


### 3.21 웹서비스 링크 사용금지

### 3.22 웹서비스 파일 업로드 및 다운로드 제한

### 3.23 웹서비스 영역의 분리
홈 디렉토리와 OS root 디렉토리와 분리해야 한다

웹 서비스 영역과 실제 시스템 영역을 따로

### 3.24 ssh 원격접속 허용
원격에서 ssh를 쓴다면 목적이 명확하게 있어야 하고

보통 ssh를 시스템 운영관리 목적으로 쓰기 때문에 접근권한을 명확하게 해야 하고

안전하게 써야 함

### 3.25 ftp 

### 3.26 ftp 계정 shell 제한

### 3.27

### 3.28 ftpuser 파일 설정

### 3.29 at 서비스 권한 설정
cron 은 반복작업할 때 쓰는데

at은 일회성 작업

### 3.30 SNMP 서비스 구동 점검
SNMP는 모니터링용으로 사용

Enterprise Management System
```
SMS NMS FMS ITSM APM
공통 모듈 / 대시보드
```
대상들하고 계속 통신하면서 MZB

이런 프로토콜은 방화벽이든 서버든 다 있음   
굳이 enable 할 필요는 없음

목적이 있으면 활성화 해도 OK    
목적이 없으면 비활성화해야 함

### 3.31 SNMP 서비스 Community String의 복잡성 설정
회사 영문 이름으로 쓰는 건 추측이 가능

### 3.32 로그온 시 경고 메시지 제공
이게 안되어 있다고 취약하다고 보기 어려운 부분이 있긴 함

### 3.33 NFS

### 3.34 expn

### 3.35 Apache 웹 서비스 정보 숨김

### 4.1 최신 보안패치
일반적인 최신버전이 안되어 있다고 해서 바로 미흡을 줄 수는 없음

### 5.1 로그의 정기적 검토 및 보고
담당자하고 인터뷰 하면서 어떤 로그를 남길 것인지   
그런 것들을 정해야 함

시스템의 안정적인?    
이상징후 감지를 위한 목적?

### 양호 취약
enable 양호   
disable 취약 

검증(불필요한 계정)이 필요함

enable, disable 같은 경우는 스크립트 결과로 바로 양호 취약 가능

검증이 필요한 부분은 인터뷰를 통해서 확인해야 함

</br></br></br>

# 윈도우



```
계정명      생성일      마지막 접속일    상태
홍길동      2023-2-1    2024-9-2        활성
김철수      2022-2-1-       -           활성
김영희      2022-2-1-   2024-3-1        활성

김철수 계정은 만들어놓고 한 번도 로그인을 하지 않았다는 것.
문제가 되는 분

김영희는 휴직(2024-3-24 시작)중임. 
비활성화 되어야 하는데 안되는 중
내부시스템 접근할 일이 없음
인사시스템 변화가 일어나면 바로 적용을 시켜야 하는데 안되고 있음
``` 


## DBMS
GRANT OPTOIN이 잘못 되어 있으면 일반 이용자가 다른 사람에게 권한을 부여할 수 있어짐

